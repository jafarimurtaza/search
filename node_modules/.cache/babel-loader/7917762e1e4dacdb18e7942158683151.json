{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread\";\nimport PropTypes from 'prop-types';\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport createConnector from '../core/createConnector';\nimport { cleanUpValue, getIndexId, refineValue, getCurrentRefinementValue, getResults } from '../core/indexUtils';\nexport var getId = function getId(props) {\n  return props.attributes[0];\n};\nvar namespace = 'hierarchicalMenu';\n\nfunction getCurrentRefinement(props, searchState, context) {\n  var currentRefinement = getCurrentRefinementValue(props, searchState, context, \"\".concat(namespace, \".\").concat(getId(props)), null);\n\n  if (currentRefinement === '') {\n    return null;\n  }\n\n  return currentRefinement;\n}\n\nfunction getValue(path, props, searchState, context) {\n  var id = props.id,\n      attributes = props.attributes,\n      separator = props.separator,\n      rootPath = props.rootPath,\n      showParentLevel = props.showParentLevel;\n  var currentRefinement = getCurrentRefinement(props, searchState, context);\n  var nextRefinement;\n\n  if (currentRefinement === null) {\n    nextRefinement = path;\n  } else {\n    var tmpSearchParameters = new algoliasearchHelper.SearchParameters({\n      hierarchicalFacets: [{\n        name: id,\n        attributes: attributes,\n        separator: separator,\n        rootPath: rootPath,\n        showParentLevel: showParentLevel\n      }]\n    });\n    nextRefinement = tmpSearchParameters.toggleHierarchicalFacetRefinement(id, currentRefinement).toggleHierarchicalFacetRefinement(id, path).getHierarchicalRefinement(id)[0];\n  }\n\n  return nextRefinement;\n}\n\nfunction transformValue(value, props, searchState, context) {\n  return value.map(function (v) {\n    return {\n      label: v.name,\n      value: getValue(v.path, props, searchState, context),\n      count: v.count,\n      isRefined: v.isRefined,\n      items: v.data && transformValue(v.data, props, searchState, context)\n    };\n  });\n}\n\nvar truncate = function truncate() {\n  var items = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 10;\n  return items.slice(0, limit).map(function () {\n    var item = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return Array.isArray(item.items) ? _objectSpread({}, item, {\n      items: truncate(item.items, limit)\n    }) : item;\n  });\n};\n\nfunction _refine(props, searchState, nextRefinement, context) {\n  var id = getId(props);\n\n  var nextValue = _defineProperty({}, id, nextRefinement || '');\n\n  var resetPage = true;\n  return refineValue(searchState, nextValue, context, resetPage, namespace);\n}\n\nfunction _cleanUp(props, searchState, context) {\n  return cleanUpValue(searchState, context, \"\".concat(namespace, \".\").concat(getId(props)));\n}\n\nvar sortBy = ['name:asc'];\n/**\n * connectHierarchicalMenu connector provides the logic to build a widget that will\n * give the user the ability to explore a tree-like structure.\n * This is commonly used for multi-level categorization of products on e-commerce\n * websites. From a UX point of view, we suggest not displaying more than two levels deep.\n * @name connectHierarchicalMenu\n * @requirements To use this widget, your attributes must be formatted in a specific way.\n * If you want for example to have a hiearchical menu of categories, objects in your index\n * should be formatted this way:\n *\n * ```json\n * {\n *   \"categories.lvl0\": \"products\",\n *   \"categories.lvl1\": \"products > fruits\",\n *   \"categories.lvl2\": \"products > fruits > citrus\"\n * }\n * ```\n *\n * It's also possible to provide more than one path for each level:\n *\n * ```json\n * {\n *   \"categories.lvl0\": [\"products\", \"goods\"],\n *   \"categories.lvl1\": [\"products > fruits\", \"goods > to eat\"]\n * }\n * ```\n *\n * All attributes passed to the `attributes` prop must be present in \"attributes for faceting\"\n * on the Algolia dashboard or configured as `attributesForFaceting` via a set settings call to the Algolia API.\n *\n * @kind connector\n * @propType {array.<string>} attributes - List of attributes to use to generate the hierarchy of the menu. See the example for the convention to follow.\n * @propType {string} [defaultRefinement] - the item value selected by default\n * @propType {boolean} [showMore=false] - Flag to activate the show more button, for toggling the number of items between limit and showMoreLimit.\n * @propType {number} [limit=10] -  The maximum number of items displayed.\n * @propType {number} [showMoreLimit=20] -  The maximum number of items displayed when the user triggers the show more. Not considered if `showMore` is false.\n * @propType {string} [separator='>'] -  Specifies the level separator used in the data.\n * @propType {string} [rootPath=null] - The path to use if the first level is not the root level.\n * @propType {boolean} [showParentLevel=true] - Flag to set if the parent level should be displayed.\n * @propType {function} [transformItems] - Function to modify the items being displayed, e.g. for filtering or sorting them. Takes an items as parameter and expects it back in return.\n * @providedPropType {function} refine - a function to toggle a refinement\n * @providedPropType {function} createURL - a function to generate a URL for the corresponding search state\n * @providedPropType {string} currentRefinement - the refinement currently applied\n * @providedPropType {array.<{items: object, count: number, isRefined: boolean, label: string, value: string}>} items - the list of items the HierarchicalMenu can display. items has the same shape as parent items.\n */\n\nexport default createConnector({\n  displayName: 'AlgoliaHierarchicalMenu',\n  propTypes: {\n    attributes: function attributes(props, propName, componentName) {\n      var isNotString = function isNotString(val) {\n        return typeof val !== 'string';\n      };\n\n      if (!Array.isArray(props[propName]) || props[propName].some(isNotString) || props[propName].length < 1) {\n        return new Error(\"Invalid prop \".concat(propName, \" supplied to \").concat(componentName, \". Expected an Array of Strings\"));\n      }\n\n      return undefined;\n    },\n    separator: PropTypes.string,\n    rootPath: PropTypes.string,\n    showParentLevel: PropTypes.bool,\n    defaultRefinement: PropTypes.string,\n    showMore: PropTypes.bool,\n    limit: PropTypes.number,\n    showMoreLimit: PropTypes.number,\n    transformItems: PropTypes.func\n  },\n  defaultProps: {\n    showMore: false,\n    limit: 10,\n    showMoreLimit: 20,\n    separator: ' > ',\n    rootPath: null,\n    showParentLevel: true\n  },\n  getProvidedProps: function getProvidedProps(props, searchState, searchResults) {\n    var showMore = props.showMore,\n        limit = props.limit,\n        showMoreLimit = props.showMoreLimit;\n    var id = getId(props);\n    var results = getResults(searchResults, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n    var isFacetPresent = Boolean(results) && Boolean(results.getFacetByName(id));\n\n    if (!isFacetPresent) {\n      return {\n        items: [],\n        currentRefinement: getCurrentRefinement(props, searchState, {\n          ais: props.contextValue,\n          multiIndexContext: props.indexContextValue\n        }),\n        canRefine: false\n      };\n    }\n\n    var itemsLimit = showMore ? showMoreLimit : limit;\n    var value = results.getFacetValues(id, {\n      sortBy: sortBy\n    });\n    var items = value.data ? transformValue(value.data, props, searchState, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    }) : [];\n    var transformedItems = props.transformItems ? props.transformItems(items) : items;\n    return {\n      items: truncate(transformedItems, itemsLimit),\n      currentRefinement: getCurrentRefinement(props, searchState, {\n        ais: props.contextValue,\n        multiIndexContext: props.indexContextValue\n      }),\n      canRefine: transformedItems.length > 0\n    };\n  },\n  refine: function refine(props, searchState, nextRefinement) {\n    return _refine(props, searchState, nextRefinement, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n  },\n  cleanUp: function cleanUp(props, searchState) {\n    return _cleanUp(props, searchState, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n  },\n  getSearchParameters: function getSearchParameters(searchParameters, props, searchState) {\n    var attributes = props.attributes,\n        separator = props.separator,\n        rootPath = props.rootPath,\n        showParentLevel = props.showParentLevel,\n        showMore = props.showMore,\n        limit = props.limit,\n        showMoreLimit = props.showMoreLimit,\n        contextValue = props.contextValue;\n    var id = getId(props);\n    var itemsLimit = showMore ? showMoreLimit : limit;\n    searchParameters = searchParameters.addHierarchicalFacet({\n      name: id,\n      attributes: attributes,\n      separator: separator,\n      rootPath: rootPath,\n      showParentLevel: showParentLevel\n    }).setQueryParameters({\n      maxValuesPerFacet: Math.max(searchParameters.maxValuesPerFacet || 0, itemsLimit)\n    });\n    var currentRefinement = getCurrentRefinement(props, searchState, {\n      ais: contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n\n    if (currentRefinement !== null) {\n      searchParameters = searchParameters.toggleHierarchicalFacetRefinement(id, currentRefinement);\n    }\n\n    return searchParameters;\n  },\n  getMetadata: function getMetadata(props, searchState) {\n    var rootAttribute = props.attributes[0];\n    var id = getId(props);\n    var currentRefinement = getCurrentRefinement(props, searchState, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n    var items = !currentRefinement ? [] : [{\n      label: \"\".concat(rootAttribute, \": \").concat(currentRefinement),\n      attribute: rootAttribute,\n      value: function value(nextState) {\n        return _refine(props, nextState, '', {\n          ais: props.contextValue,\n          multiIndexContext: props.indexContextValue\n        });\n      },\n      currentRefinement: currentRefinement\n    }];\n    return {\n      id: id,\n      index: getIndexId({\n        ais: props.contextValue,\n        multiIndexContext: props.indexContextValue\n      }),\n      items: items\n    };\n  }\n});","map":{"version":3,"sources":["C:/Users/Murtaza Jafari/Desktop/product-search/product/searcbox/node_modules/react-instantsearch-core/dist/es/connectors/connectHierarchicalMenu.js"],"names":["_defineProperty","_objectSpread","PropTypes","algoliasearchHelper","createConnector","cleanUpValue","getIndexId","refineValue","getCurrentRefinementValue","getResults","getId","props","attributes","namespace","getCurrentRefinement","searchState","context","currentRefinement","concat","getValue","path","id","separator","rootPath","showParentLevel","nextRefinement","tmpSearchParameters","SearchParameters","hierarchicalFacets","name","toggleHierarchicalFacetRefinement","getHierarchicalRefinement","transformValue","value","map","v","label","count","isRefined","items","data","truncate","arguments","length","undefined","limit","slice","item","Array","isArray","_refine","nextValue","resetPage","_cleanUp","sortBy","displayName","propTypes","propName","componentName","isNotString","val","some","Error","string","bool","defaultRefinement","showMore","number","showMoreLimit","transformItems","func","defaultProps","getProvidedProps","searchResults","results","ais","contextValue","multiIndexContext","indexContextValue","isFacetPresent","Boolean","getFacetByName","canRefine","itemsLimit","getFacetValues","transformedItems","refine","cleanUp","getSearchParameters","searchParameters","addHierarchicalFacet","setQueryParameters","maxValuesPerFacet","Math","max","getMetadata","rootAttribute","attribute","nextState","index"],"mappings":"AAAA,OAAOA,eAAP,MAA4B,2CAA5B;AACA,OAAOC,aAAP,MAA0B,yCAA1B;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,mBAAP,MAAgC,sBAAhC;AACA,OAAOC,eAAP,MAA4B,yBAA5B;AACA,SAASC,YAAT,EAAuBC,UAAvB,EAAmCC,WAAnC,EAAgDC,yBAAhD,EAA2EC,UAA3E,QAA6F,oBAA7F;AACA,OAAO,IAAIC,KAAK,GAAG,SAASA,KAAT,CAAeC,KAAf,EAAsB;AACvC,SAAOA,KAAK,CAACC,UAAN,CAAiB,CAAjB,CAAP;AACD,CAFM;AAGP,IAAIC,SAAS,GAAG,kBAAhB;;AAEA,SAASC,oBAAT,CAA8BH,KAA9B,EAAqCI,WAArC,EAAkDC,OAAlD,EAA2D;AACzD,MAAIC,iBAAiB,GAAGT,yBAAyB,CAACG,KAAD,EAAQI,WAAR,EAAqBC,OAArB,EAA8B,GAAGE,MAAH,CAAUL,SAAV,EAAqB,GAArB,EAA0BK,MAA1B,CAAiCR,KAAK,CAACC,KAAD,CAAtC,CAA9B,EAA8E,IAA9E,CAAjD;;AAEA,MAAIM,iBAAiB,KAAK,EAA1B,EAA8B;AAC5B,WAAO,IAAP;AACD;;AAED,SAAOA,iBAAP;AACD;;AAED,SAASE,QAAT,CAAkBC,IAAlB,EAAwBT,KAAxB,EAA+BI,WAA/B,EAA4CC,OAA5C,EAAqD;AACnD,MAAIK,EAAE,GAAGV,KAAK,CAACU,EAAf;AAAA,MACIT,UAAU,GAAGD,KAAK,CAACC,UADvB;AAAA,MAEIU,SAAS,GAAGX,KAAK,CAACW,SAFtB;AAAA,MAGIC,QAAQ,GAAGZ,KAAK,CAACY,QAHrB;AAAA,MAIIC,eAAe,GAAGb,KAAK,CAACa,eAJ5B;AAKA,MAAIP,iBAAiB,GAAGH,oBAAoB,CAACH,KAAD,EAAQI,WAAR,EAAqBC,OAArB,CAA5C;AACA,MAAIS,cAAJ;;AAEA,MAAIR,iBAAiB,KAAK,IAA1B,EAAgC;AAC9BQ,IAAAA,cAAc,GAAGL,IAAjB;AACD,GAFD,MAEO;AACL,QAAIM,mBAAmB,GAAG,IAAIvB,mBAAmB,CAACwB,gBAAxB,CAAyC;AACjEC,MAAAA,kBAAkB,EAAE,CAAC;AACnBC,QAAAA,IAAI,EAAER,EADa;AAEnBT,QAAAA,UAAU,EAAEA,UAFO;AAGnBU,QAAAA,SAAS,EAAEA,SAHQ;AAInBC,QAAAA,QAAQ,EAAEA,QAJS;AAKnBC,QAAAA,eAAe,EAAEA;AALE,OAAD;AAD6C,KAAzC,CAA1B;AASAC,IAAAA,cAAc,GAAGC,mBAAmB,CAACI,iCAApB,CAAsDT,EAAtD,EAA0DJ,iBAA1D,EAA6Ea,iCAA7E,CAA+GT,EAA/G,EAAmHD,IAAnH,EAAyHW,yBAAzH,CAAmJV,EAAnJ,EAAuJ,CAAvJ,CAAjB;AACD;;AAED,SAAOI,cAAP;AACD;;AAED,SAASO,cAAT,CAAwBC,KAAxB,EAA+BtB,KAA/B,EAAsCI,WAAtC,EAAmDC,OAAnD,EAA4D;AAC1D,SAAOiB,KAAK,CAACC,GAAN,CAAU,UAAUC,CAAV,EAAa;AAC5B,WAAO;AACLC,MAAAA,KAAK,EAAED,CAAC,CAACN,IADJ;AAELI,MAAAA,KAAK,EAAEd,QAAQ,CAACgB,CAAC,CAACf,IAAH,EAAST,KAAT,EAAgBI,WAAhB,EAA6BC,OAA7B,CAFV;AAGLqB,MAAAA,KAAK,EAAEF,CAAC,CAACE,KAHJ;AAILC,MAAAA,SAAS,EAAEH,CAAC,CAACG,SAJR;AAKLC,MAAAA,KAAK,EAAEJ,CAAC,CAACK,IAAF,IAAUR,cAAc,CAACG,CAAC,CAACK,IAAH,EAAS7B,KAAT,EAAgBI,WAAhB,EAA6BC,OAA7B;AAL1B,KAAP;AAOD,GARM,CAAP;AASD;;AAED,IAAIyB,QAAQ,GAAG,SAASA,QAAT,GAAoB;AACjC,MAAIF,KAAK,GAAGG,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAhF;AACA,MAAIG,KAAK,GAAGH,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAhF;AACA,SAAOH,KAAK,CAACO,KAAN,CAAY,CAAZ,EAAeD,KAAf,EAAsBX,GAAtB,CAA0B,YAAY;AAC3C,QAAIa,IAAI,GAAGL,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBE,SAAzC,GAAqDF,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAA/E;AACA,WAAOM,KAAK,CAACC,OAAN,CAAcF,IAAI,CAACR,KAAnB,IAA4BtC,aAAa,CAAC,EAAD,EAAK8C,IAAL,EAAW;AACzDR,MAAAA,KAAK,EAAEE,QAAQ,CAACM,IAAI,CAACR,KAAN,EAAaM,KAAb;AAD0C,KAAX,CAAzC,GAEFE,IAFL;AAGD,GALM,CAAP;AAMD,CATD;;AAWA,SAASG,OAAT,CAAiBvC,KAAjB,EAAwBI,WAAxB,EAAqCU,cAArC,EAAqDT,OAArD,EAA8D;AAC5D,MAAIK,EAAE,GAAGX,KAAK,CAACC,KAAD,CAAd;;AAEA,MAAIwC,SAAS,GAAGnD,eAAe,CAAC,EAAD,EAAKqB,EAAL,EAASI,cAAc,IAAI,EAA3B,CAA/B;;AAEA,MAAI2B,SAAS,GAAG,IAAhB;AACA,SAAO7C,WAAW,CAACQ,WAAD,EAAcoC,SAAd,EAAyBnC,OAAzB,EAAkCoC,SAAlC,EAA6CvC,SAA7C,CAAlB;AACD;;AAED,SAASwC,QAAT,CAAkB1C,KAAlB,EAAyBI,WAAzB,EAAsCC,OAAtC,EAA+C;AAC7C,SAAOX,YAAY,CAACU,WAAD,EAAcC,OAAd,EAAuB,GAAGE,MAAH,CAAUL,SAAV,EAAqB,GAArB,EAA0BK,MAA1B,CAAiCR,KAAK,CAACC,KAAD,CAAtC,CAAvB,CAAnB;AACD;;AAED,IAAI2C,MAAM,GAAG,CAAC,UAAD,CAAb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAelD,eAAe,CAAC;AAC7BmD,EAAAA,WAAW,EAAE,yBADgB;AAE7BC,EAAAA,SAAS,EAAE;AACT5C,IAAAA,UAAU,EAAE,SAASA,UAAT,CAAoBD,KAApB,EAA2B8C,QAA3B,EAAqCC,aAArC,EAAoD;AAC9D,UAAIC,WAAW,GAAG,SAASA,WAAT,CAAqBC,GAArB,EAA0B;AAC1C,eAAO,OAAOA,GAAP,KAAe,QAAtB;AACD,OAFD;;AAIA,UAAI,CAACZ,KAAK,CAACC,OAAN,CAActC,KAAK,CAAC8C,QAAD,CAAnB,CAAD,IAAmC9C,KAAK,CAAC8C,QAAD,CAAL,CAAgBI,IAAhB,CAAqBF,WAArB,CAAnC,IAAwEhD,KAAK,CAAC8C,QAAD,CAAL,CAAgBd,MAAhB,GAAyB,CAArG,EAAwG;AACtG,eAAO,IAAImB,KAAJ,CAAU,gBAAgB5C,MAAhB,CAAuBuC,QAAvB,EAAiC,eAAjC,EAAkDvC,MAAlD,CAAyDwC,aAAzD,EAAwE,gCAAxE,CAAV,CAAP;AACD;;AAED,aAAOd,SAAP;AACD,KAXQ;AAYTtB,IAAAA,SAAS,EAAEpB,SAAS,CAAC6D,MAZZ;AAaTxC,IAAAA,QAAQ,EAAErB,SAAS,CAAC6D,MAbX;AAcTvC,IAAAA,eAAe,EAAEtB,SAAS,CAAC8D,IAdlB;AAeTC,IAAAA,iBAAiB,EAAE/D,SAAS,CAAC6D,MAfpB;AAgBTG,IAAAA,QAAQ,EAAEhE,SAAS,CAAC8D,IAhBX;AAiBTnB,IAAAA,KAAK,EAAE3C,SAAS,CAACiE,MAjBR;AAkBTC,IAAAA,aAAa,EAAElE,SAAS,CAACiE,MAlBhB;AAmBTE,IAAAA,cAAc,EAAEnE,SAAS,CAACoE;AAnBjB,GAFkB;AAuB7BC,EAAAA,YAAY,EAAE;AACZL,IAAAA,QAAQ,EAAE,KADE;AAEZrB,IAAAA,KAAK,EAAE,EAFK;AAGZuB,IAAAA,aAAa,EAAE,EAHH;AAIZ9C,IAAAA,SAAS,EAAE,KAJC;AAKZC,IAAAA,QAAQ,EAAE,IALE;AAMZC,IAAAA,eAAe,EAAE;AANL,GAvBe;AA+B7BgD,EAAAA,gBAAgB,EAAE,SAASA,gBAAT,CAA0B7D,KAA1B,EAAiCI,WAAjC,EAA8C0D,aAA9C,EAA6D;AAC7E,QAAIP,QAAQ,GAAGvD,KAAK,CAACuD,QAArB;AAAA,QACIrB,KAAK,GAAGlC,KAAK,CAACkC,KADlB;AAAA,QAEIuB,aAAa,GAAGzD,KAAK,CAACyD,aAF1B;AAGA,QAAI/C,EAAE,GAAGX,KAAK,CAACC,KAAD,CAAd;AACA,QAAI+D,OAAO,GAAGjE,UAAU,CAACgE,aAAD,EAAgB;AACtCE,MAAAA,GAAG,EAAEhE,KAAK,CAACiE,YAD2B;AAEtCC,MAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFa,KAAhB,CAAxB;AAIA,QAAIC,cAAc,GAAGC,OAAO,CAACN,OAAD,CAAP,IAAoBM,OAAO,CAACN,OAAO,CAACO,cAAR,CAAuB5D,EAAvB,CAAD,CAAhD;;AAEA,QAAI,CAAC0D,cAAL,EAAqB;AACnB,aAAO;AACLxC,QAAAA,KAAK,EAAE,EADF;AAELtB,QAAAA,iBAAiB,EAAEH,oBAAoB,CAACH,KAAD,EAAQI,WAAR,EAAqB;AAC1D4D,UAAAA,GAAG,EAAEhE,KAAK,CAACiE,YAD+C;AAE1DC,UAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFiC,SAArB,CAFlC;AAMLI,QAAAA,SAAS,EAAE;AANN,OAAP;AAQD;;AAED,QAAIC,UAAU,GAAGjB,QAAQ,GAAGE,aAAH,GAAmBvB,KAA5C;AACA,QAAIZ,KAAK,GAAGyC,OAAO,CAACU,cAAR,CAAuB/D,EAAvB,EAA2B;AACrCiC,MAAAA,MAAM,EAAEA;AAD6B,KAA3B,CAAZ;AAGA,QAAIf,KAAK,GAAGN,KAAK,CAACO,IAAN,GAAaR,cAAc,CAACC,KAAK,CAACO,IAAP,EAAa7B,KAAb,EAAoBI,WAApB,EAAiC;AACtE4D,MAAAA,GAAG,EAAEhE,KAAK,CAACiE,YAD2D;AAEtEC,MAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAF6C,KAAjC,CAA3B,GAGP,EAHL;AAIA,QAAIO,gBAAgB,GAAG1E,KAAK,CAAC0D,cAAN,GAAuB1D,KAAK,CAAC0D,cAAN,CAAqB9B,KAArB,CAAvB,GAAqDA,KAA5E;AACA,WAAO;AACLA,MAAAA,KAAK,EAAEE,QAAQ,CAAC4C,gBAAD,EAAmBF,UAAnB,CADV;AAELlE,MAAAA,iBAAiB,EAAEH,oBAAoB,CAACH,KAAD,EAAQI,WAAR,EAAqB;AAC1D4D,QAAAA,GAAG,EAAEhE,KAAK,CAACiE,YAD+C;AAE1DC,QAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFiC,OAArB,CAFlC;AAMLI,MAAAA,SAAS,EAAEG,gBAAgB,CAAC1C,MAAjB,GAA0B;AANhC,KAAP;AAQD,GAtE4B;AAuE7B2C,EAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB3E,KAAhB,EAAuBI,WAAvB,EAAoCU,cAApC,EAAoD;AAC1D,WAAOyB,OAAO,CAACvC,KAAD,EAAQI,WAAR,EAAqBU,cAArB,EAAqC;AACjDkD,MAAAA,GAAG,EAAEhE,KAAK,CAACiE,YADsC;AAEjDC,MAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFwB,KAArC,CAAd;AAID,GA5E4B;AA6E7BS,EAAAA,OAAO,EAAE,SAASA,OAAT,CAAiB5E,KAAjB,EAAwBI,WAAxB,EAAqC;AAC5C,WAAOsC,QAAQ,CAAC1C,KAAD,EAAQI,WAAR,EAAqB;AAClC4D,MAAAA,GAAG,EAAEhE,KAAK,CAACiE,YADuB;AAElCC,MAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFS,KAArB,CAAf;AAID,GAlF4B;AAmF7BU,EAAAA,mBAAmB,EAAE,SAASA,mBAAT,CAA6BC,gBAA7B,EAA+C9E,KAA/C,EAAsDI,WAAtD,EAAmE;AACtF,QAAIH,UAAU,GAAGD,KAAK,CAACC,UAAvB;AAAA,QACIU,SAAS,GAAGX,KAAK,CAACW,SADtB;AAAA,QAEIC,QAAQ,GAAGZ,KAAK,CAACY,QAFrB;AAAA,QAGIC,eAAe,GAAGb,KAAK,CAACa,eAH5B;AAAA,QAII0C,QAAQ,GAAGvD,KAAK,CAACuD,QAJrB;AAAA,QAKIrB,KAAK,GAAGlC,KAAK,CAACkC,KALlB;AAAA,QAMIuB,aAAa,GAAGzD,KAAK,CAACyD,aAN1B;AAAA,QAOIQ,YAAY,GAAGjE,KAAK,CAACiE,YAPzB;AAQA,QAAIvD,EAAE,GAAGX,KAAK,CAACC,KAAD,CAAd;AACA,QAAIwE,UAAU,GAAGjB,QAAQ,GAAGE,aAAH,GAAmBvB,KAA5C;AACA4C,IAAAA,gBAAgB,GAAGA,gBAAgB,CAACC,oBAAjB,CAAsC;AACvD7D,MAAAA,IAAI,EAAER,EADiD;AAEvDT,MAAAA,UAAU,EAAEA,UAF2C;AAGvDU,MAAAA,SAAS,EAAEA,SAH4C;AAIvDC,MAAAA,QAAQ,EAAEA,QAJ6C;AAKvDC,MAAAA,eAAe,EAAEA;AALsC,KAAtC,EAMhBmE,kBANgB,CAMG;AACpBC,MAAAA,iBAAiB,EAAEC,IAAI,CAACC,GAAL,CAASL,gBAAgB,CAACG,iBAAjB,IAAsC,CAA/C,EAAkDT,UAAlD;AADC,KANH,CAAnB;AASA,QAAIlE,iBAAiB,GAAGH,oBAAoB,CAACH,KAAD,EAAQI,WAAR,EAAqB;AAC/D4D,MAAAA,GAAG,EAAEC,YAD0D;AAE/DC,MAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFsC,KAArB,CAA5C;;AAKA,QAAI7D,iBAAiB,KAAK,IAA1B,EAAgC;AAC9BwE,MAAAA,gBAAgB,GAAGA,gBAAgB,CAAC3D,iCAAjB,CAAmDT,EAAnD,EAAuDJ,iBAAvD,CAAnB;AACD;;AAED,WAAOwE,gBAAP;AACD,GAjH4B;AAkH7BM,EAAAA,WAAW,EAAE,SAASA,WAAT,CAAqBpF,KAArB,EAA4BI,WAA5B,EAAyC;AACpD,QAAIiF,aAAa,GAAGrF,KAAK,CAACC,UAAN,CAAiB,CAAjB,CAApB;AACA,QAAIS,EAAE,GAAGX,KAAK,CAACC,KAAD,CAAd;AACA,QAAIM,iBAAiB,GAAGH,oBAAoB,CAACH,KAAD,EAAQI,WAAR,EAAqB;AAC/D4D,MAAAA,GAAG,EAAEhE,KAAK,CAACiE,YADoD;AAE/DC,MAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFsC,KAArB,CAA5C;AAIA,QAAIvC,KAAK,GAAG,CAACtB,iBAAD,GAAqB,EAArB,GAA0B,CAAC;AACrCmB,MAAAA,KAAK,EAAE,GAAGlB,MAAH,CAAU8E,aAAV,EAAyB,IAAzB,EAA+B9E,MAA/B,CAAsCD,iBAAtC,CAD8B;AAErCgF,MAAAA,SAAS,EAAED,aAF0B;AAGrC/D,MAAAA,KAAK,EAAE,SAASA,KAAT,CAAeiE,SAAf,EAA0B;AAC/B,eAAOhD,OAAO,CAACvC,KAAD,EAAQuF,SAAR,EAAmB,EAAnB,EAAuB;AACnCvB,UAAAA,GAAG,EAAEhE,KAAK,CAACiE,YADwB;AAEnCC,UAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFU,SAAvB,CAAd;AAID,OARoC;AASrC7D,MAAAA,iBAAiB,EAAEA;AATkB,KAAD,CAAtC;AAWA,WAAO;AACLI,MAAAA,EAAE,EAAEA,EADC;AAEL8E,MAAAA,KAAK,EAAE7F,UAAU,CAAC;AAChBqE,QAAAA,GAAG,EAAEhE,KAAK,CAACiE,YADK;AAEhBC,QAAAA,iBAAiB,EAAElE,KAAK,CAACmE;AAFT,OAAD,CAFZ;AAMLvC,MAAAA,KAAK,EAAEA;AANF,KAAP;AAQD;AA5I4B,CAAD,CAA9B","sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread\";\nimport PropTypes from 'prop-types';\nimport algoliasearchHelper from 'algoliasearch-helper';\nimport createConnector from '../core/createConnector';\nimport { cleanUpValue, getIndexId, refineValue, getCurrentRefinementValue, getResults } from '../core/indexUtils';\nexport var getId = function getId(props) {\n  return props.attributes[0];\n};\nvar namespace = 'hierarchicalMenu';\n\nfunction getCurrentRefinement(props, searchState, context) {\n  var currentRefinement = getCurrentRefinementValue(props, searchState, context, \"\".concat(namespace, \".\").concat(getId(props)), null);\n\n  if (currentRefinement === '') {\n    return null;\n  }\n\n  return currentRefinement;\n}\n\nfunction getValue(path, props, searchState, context) {\n  var id = props.id,\n      attributes = props.attributes,\n      separator = props.separator,\n      rootPath = props.rootPath,\n      showParentLevel = props.showParentLevel;\n  var currentRefinement = getCurrentRefinement(props, searchState, context);\n  var nextRefinement;\n\n  if (currentRefinement === null) {\n    nextRefinement = path;\n  } else {\n    var tmpSearchParameters = new algoliasearchHelper.SearchParameters({\n      hierarchicalFacets: [{\n        name: id,\n        attributes: attributes,\n        separator: separator,\n        rootPath: rootPath,\n        showParentLevel: showParentLevel\n      }]\n    });\n    nextRefinement = tmpSearchParameters.toggleHierarchicalFacetRefinement(id, currentRefinement).toggleHierarchicalFacetRefinement(id, path).getHierarchicalRefinement(id)[0];\n  }\n\n  return nextRefinement;\n}\n\nfunction transformValue(value, props, searchState, context) {\n  return value.map(function (v) {\n    return {\n      label: v.name,\n      value: getValue(v.path, props, searchState, context),\n      count: v.count,\n      isRefined: v.isRefined,\n      items: v.data && transformValue(v.data, props, searchState, context)\n    };\n  });\n}\n\nvar truncate = function truncate() {\n  var items = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 10;\n  return items.slice(0, limit).map(function () {\n    var item = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return Array.isArray(item.items) ? _objectSpread({}, item, {\n      items: truncate(item.items, limit)\n    }) : item;\n  });\n};\n\nfunction _refine(props, searchState, nextRefinement, context) {\n  var id = getId(props);\n\n  var nextValue = _defineProperty({}, id, nextRefinement || '');\n\n  var resetPage = true;\n  return refineValue(searchState, nextValue, context, resetPage, namespace);\n}\n\nfunction _cleanUp(props, searchState, context) {\n  return cleanUpValue(searchState, context, \"\".concat(namespace, \".\").concat(getId(props)));\n}\n\nvar sortBy = ['name:asc'];\n/**\n * connectHierarchicalMenu connector provides the logic to build a widget that will\n * give the user the ability to explore a tree-like structure.\n * This is commonly used for multi-level categorization of products on e-commerce\n * websites. From a UX point of view, we suggest not displaying more than two levels deep.\n * @name connectHierarchicalMenu\n * @requirements To use this widget, your attributes must be formatted in a specific way.\n * If you want for example to have a hiearchical menu of categories, objects in your index\n * should be formatted this way:\n *\n * ```json\n * {\n *   \"categories.lvl0\": \"products\",\n *   \"categories.lvl1\": \"products > fruits\",\n *   \"categories.lvl2\": \"products > fruits > citrus\"\n * }\n * ```\n *\n * It's also possible to provide more than one path for each level:\n *\n * ```json\n * {\n *   \"categories.lvl0\": [\"products\", \"goods\"],\n *   \"categories.lvl1\": [\"products > fruits\", \"goods > to eat\"]\n * }\n * ```\n *\n * All attributes passed to the `attributes` prop must be present in \"attributes for faceting\"\n * on the Algolia dashboard or configured as `attributesForFaceting` via a set settings call to the Algolia API.\n *\n * @kind connector\n * @propType {array.<string>} attributes - List of attributes to use to generate the hierarchy of the menu. See the example for the convention to follow.\n * @propType {string} [defaultRefinement] - the item value selected by default\n * @propType {boolean} [showMore=false] - Flag to activate the show more button, for toggling the number of items between limit and showMoreLimit.\n * @propType {number} [limit=10] -  The maximum number of items displayed.\n * @propType {number} [showMoreLimit=20] -  The maximum number of items displayed when the user triggers the show more. Not considered if `showMore` is false.\n * @propType {string} [separator='>'] -  Specifies the level separator used in the data.\n * @propType {string} [rootPath=null] - The path to use if the first level is not the root level.\n * @propType {boolean} [showParentLevel=true] - Flag to set if the parent level should be displayed.\n * @propType {function} [transformItems] - Function to modify the items being displayed, e.g. for filtering or sorting them. Takes an items as parameter and expects it back in return.\n * @providedPropType {function} refine - a function to toggle a refinement\n * @providedPropType {function} createURL - a function to generate a URL for the corresponding search state\n * @providedPropType {string} currentRefinement - the refinement currently applied\n * @providedPropType {array.<{items: object, count: number, isRefined: boolean, label: string, value: string}>} items - the list of items the HierarchicalMenu can display. items has the same shape as parent items.\n */\n\nexport default createConnector({\n  displayName: 'AlgoliaHierarchicalMenu',\n  propTypes: {\n    attributes: function attributes(props, propName, componentName) {\n      var isNotString = function isNotString(val) {\n        return typeof val !== 'string';\n      };\n\n      if (!Array.isArray(props[propName]) || props[propName].some(isNotString) || props[propName].length < 1) {\n        return new Error(\"Invalid prop \".concat(propName, \" supplied to \").concat(componentName, \". Expected an Array of Strings\"));\n      }\n\n      return undefined;\n    },\n    separator: PropTypes.string,\n    rootPath: PropTypes.string,\n    showParentLevel: PropTypes.bool,\n    defaultRefinement: PropTypes.string,\n    showMore: PropTypes.bool,\n    limit: PropTypes.number,\n    showMoreLimit: PropTypes.number,\n    transformItems: PropTypes.func\n  },\n  defaultProps: {\n    showMore: false,\n    limit: 10,\n    showMoreLimit: 20,\n    separator: ' > ',\n    rootPath: null,\n    showParentLevel: true\n  },\n  getProvidedProps: function getProvidedProps(props, searchState, searchResults) {\n    var showMore = props.showMore,\n        limit = props.limit,\n        showMoreLimit = props.showMoreLimit;\n    var id = getId(props);\n    var results = getResults(searchResults, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n    var isFacetPresent = Boolean(results) && Boolean(results.getFacetByName(id));\n\n    if (!isFacetPresent) {\n      return {\n        items: [],\n        currentRefinement: getCurrentRefinement(props, searchState, {\n          ais: props.contextValue,\n          multiIndexContext: props.indexContextValue\n        }),\n        canRefine: false\n      };\n    }\n\n    var itemsLimit = showMore ? showMoreLimit : limit;\n    var value = results.getFacetValues(id, {\n      sortBy: sortBy\n    });\n    var items = value.data ? transformValue(value.data, props, searchState, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    }) : [];\n    var transformedItems = props.transformItems ? props.transformItems(items) : items;\n    return {\n      items: truncate(transformedItems, itemsLimit),\n      currentRefinement: getCurrentRefinement(props, searchState, {\n        ais: props.contextValue,\n        multiIndexContext: props.indexContextValue\n      }),\n      canRefine: transformedItems.length > 0\n    };\n  },\n  refine: function refine(props, searchState, nextRefinement) {\n    return _refine(props, searchState, nextRefinement, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n  },\n  cleanUp: function cleanUp(props, searchState) {\n    return _cleanUp(props, searchState, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n  },\n  getSearchParameters: function getSearchParameters(searchParameters, props, searchState) {\n    var attributes = props.attributes,\n        separator = props.separator,\n        rootPath = props.rootPath,\n        showParentLevel = props.showParentLevel,\n        showMore = props.showMore,\n        limit = props.limit,\n        showMoreLimit = props.showMoreLimit,\n        contextValue = props.contextValue;\n    var id = getId(props);\n    var itemsLimit = showMore ? showMoreLimit : limit;\n    searchParameters = searchParameters.addHierarchicalFacet({\n      name: id,\n      attributes: attributes,\n      separator: separator,\n      rootPath: rootPath,\n      showParentLevel: showParentLevel\n    }).setQueryParameters({\n      maxValuesPerFacet: Math.max(searchParameters.maxValuesPerFacet || 0, itemsLimit)\n    });\n    var currentRefinement = getCurrentRefinement(props, searchState, {\n      ais: contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n\n    if (currentRefinement !== null) {\n      searchParameters = searchParameters.toggleHierarchicalFacetRefinement(id, currentRefinement);\n    }\n\n    return searchParameters;\n  },\n  getMetadata: function getMetadata(props, searchState) {\n    var rootAttribute = props.attributes[0];\n    var id = getId(props);\n    var currentRefinement = getCurrentRefinement(props, searchState, {\n      ais: props.contextValue,\n      multiIndexContext: props.indexContextValue\n    });\n    var items = !currentRefinement ? [] : [{\n      label: \"\".concat(rootAttribute, \": \").concat(currentRefinement),\n      attribute: rootAttribute,\n      value: function value(nextState) {\n        return _refine(props, nextState, '', {\n          ais: props.contextValue,\n          multiIndexContext: props.indexContextValue\n        });\n      },\n      currentRefinement: currentRefinement\n    }];\n    return {\n      id: id,\n      index: getIndexId({\n        ais: props.contextValue,\n        multiIndexContext: props.indexContextValue\n      }),\n      items: items\n    };\n  }\n});"]},"metadata":{},"sourceType":"module"}